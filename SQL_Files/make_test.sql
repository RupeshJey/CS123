-- DROP TABLE IF EXISTS entry_geom; 
-- DROP TABLE IF EXISTS leaf_node_entries; 
-- DROP TABLE IF EXISTS inner_node_entries; 
-- DROP TABLE IF EXISTS rtree_entries; 
-- DROP TABLE IF EXISTS nodes; 
-- DROP TABLE IF EXISTS tropomi;


CALL rtree_insert(' 2019-02-01 18:08:05 ' , 0.4429, 5.1581, -68.582, 5.0883, -68.5336);
CALL rtree_insert(' 2019-02-01 11:00:23 ' , -0.2148, -71.1521, 57.0138, -71.2264, 57.1916);
CALL rtree_insert(' 2019-02-01 04:47:14 ' , -0.1507, 44.5753, 127.2688, 44.5073, 127.346);
CALL rtree_insert(' 2019-02-01 13:03:47 ' , 0.7356, 5.8094, 7.4316, 5.7397, 7.4801);
CALL rtree_insert(' 2019-02-01 13:08:11 ' , 0.1854, 21.6654, 6.8173, 21.5971, 6.8818);
CALL rtree_insert(' 2019-02-01 14:22:23 ' , 1.754, -75.5778, 2.0205, -75.6575, 2.2817);
CALL rtree_insert(' 2019-02-01 11:26:36 ' , -0.1919, 21.3132, 31.6213, 21.2447, 31.6818);
CALL rtree_insert(' 2019-02-01 17:44:20 ' , -0.2097, -71.4219, -7.3373, -71.5099, -7.0282);
CALL rtree_insert(' 2019-02-01 18:04:58 ' , 1.0575, -5.2995, -62.2959, -5.3695, -62.2247);
CALL rtree_insert(' 2019-02-01 11:29:11 ' , -0.5085, 30.3646, 29.0092, 30.2961, 29.0712);
CALL rtree_insert(' 2019-02-01 18:09:58 ' , 1.0385, 10.6741, -74.6171, 10.5995, -74.5645);
CALL rtree_insert(' 2019-02-01 11:25:06 ' , -0.1537, 13.5811, 22.7713, 13.4963, 22.8462);
CALL rtree_insert(' 2019-02-01 17:58:42 ' , -0.6749, -29.7907, -68.9011, -29.8705, -68.824);
CALL rtree_insert(' 2019-02-01 11:25:42 ' , 0.5139, 14.305, 18.8121, 14.1988, 18.9337);
CALL rtree_insert(' 2019-02-01 04:46:17 ' , 0.1632, 41.2775, 128.6396, 41.2097, 128.715);
CALL rtree_insert(' 2019-02-01 16:19:59 ' , 1.7873, -18.5722, -39.8502, -18.643, -39.8015);
CALL rtree_insert(' 2019-02-01 04:13:46 ' , 0.1342, -74.3749, 152.4469, -74.4543, 152.6864);
CALL rtree_insert(' 2019-02-01 09:47:38 ' , 1.1256, 27.9899, 45.0724, 27.9079, 45.1472);
CALL rtree_insert(' 2019-02-01 18:05:22 ' , 1.6749, -6.7875, -74.9966, -6.8743, -74.915);
CALL rtree_insert(' 2019-02-01 09:49:20 ' , 0.0497, 35.3428, 48.2523, 35.2715, 48.3105);
CALL rtree_insert(' 2019-02-01 04:46:48 ' , -0.1419, 43.2888, 132.6614, 43.2252, 132.7765);
CALL rtree_insert(' 2019-02-01 04:26:09 ' , -0.5884, -30.7519, 138.7798, -30.8242, 138.8359);
CALL rtree_insert(' 2019-02-01 12:57:10 ' , 0.7244, -16.9434, 16.26, -17.0142, 16.3312);
CALL rtree_insert(' 2019-02-01 06:07:26 ' , -0.0937, -29.9603, 121.4004, -30.0321, 121.4792);
CALL rtree_insert(' 2019-02-01 16:23:23 ' , 1.0876, -6.6596, -42.9049, -6.7306, -42.8586);
CALL rtree_insert(' 2019-02-01 17:58:21 ' , 2.6274, -28.1874, -55.0835, -28.2608, -54.9906);
CALL rtree_insert(' 2019-02-01 04:49:43 ' , -0.2908, 51.841, 115.6158, 51.7668, 115.703);
CALL rtree_insert(' 2019-02-01 06:16:40 ' , 1.2398, -0.9016, 100.32, -0.9942, 100.4136);
CALL rtree_insert(' 2019-02-01 04:14:36 ' , -0.7127, -70.2693, 158.9163, -70.3429, 159.0847);
CALL rtree_insert(' 2019-02-01 06:26:05 ' , 0.2361, 34.8696, 101.2408, 34.7998, 101.2985);
CALL rtree_insert(' 2019-02-01 18:21:30 ' , -0.6795, 52.11, -81.9797, 52.04, -81.8992);
CALL rtree_insert(' 2019-02-01 08:01:20 ' , 1.0807, 12.4549, 79.202, 12.3833, 79.2498);
CALL rtree_insert(' 2019-02-01 08:04:33 ' , 0.8175, 24.478, 80.4059, 24.409, 80.4619);
CALL rtree_insert(' 2019-02-01 03:08:23 ' , -0.303, 51.1865, 136.5455, 51.1032, 136.6547);
CALL rtree_insert(' 2019-02-02 00:30:52 ' , 0.1272, -75.9107, -137.6215, -75.9853, -137.3652);
CALL rtree_insert(' 2019-02-01 06:28:10 ' , -0.1846, 42.8086, 106.7914, 42.7441, 106.899);
CALL rtree_insert(' 2019-02-01 14:47:32 ' , -0.0718, 14.2017, -16.6092, 14.1332, -16.5444);

SELECT * FROM tropomi;
SELECT * FROM leaf_node_entries; 
SELECT * FROM inner_node_entries; 
SELECT * FROM nodes; 
SELECT * FROM entry_geom ; 
SELECT * FROM rtree_entries; 
SELECT * FROM rtree_properties;

SELECT * FROM traverser; 

SELECT * FROM (entry_geom NATURAL JOIN leaf_node_entries) UNION 
SELECT * FROM (entry_geom NATURAL JOIN inner_node_entries); 

SELECT SUM(num_entries) FROM nodes WHERE level = 1;
